---
sidebar: sidebar 
permalink: oracle/oracle-asar2-config-thin-provisioning.html 
keywords: thin provisioning, oracle, ASA r2 
summary: ASA r2를 사용한 Oracle 및 ONTAP 씬 프로비저닝 
searchtitle: ASA r2에서 Oracle 데이터베이스를 사용한 씬 프로비저닝 
---
= 씬 프로비저닝
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
ASA r2에서 Oracle 데이터베이스에 대한 씬 프로비저닝은 물리적으로 사용 가능한 공간보다 더 많은 논리적 공간을 구성해야 하므로 신중한 계획이 필요합니다. 씬 프로비저닝은 올바르게 구현될 경우 상당한 비용 절감과 관리 용이성 향상을 제공합니다.

씬 프로비저닝은 ASA r2의 핵심 기능이며 ONTAP 효율성 기술과 밀접한 관련이 있습니다. 두 기술 모두 시스템의 물리적 용량보다 더 많은 논리적 데이터를 저장할 수 있도록 해주기 때문입니다. ASA r2 시스템은 SAN 전용이며, 씬 프로비저닝은 스토리지 가용 영역(SAZ) 내의 스토리지 장치 및 LUN에 적용됩니다.


NOTE: ASA r2 스토리지 유닛은 기본적으로 씬 프로비저닝됩니다.

스냅샷을 사용하는 거의 모든 경우는 씬 프로비저닝과 관련이 있습니다. 예를 들어, 30일 동안의 스냅샷을 저장하는 일반적인 10TiB 데이터베이스는 논리적으로는 310TiB의 데이터처럼 보일 수 있지만, 스냅샷에는 변경된 블록만 저장되므로 실제로 사용되는 물리적 공간은 12TiB에서 15TiB에 불과합니다.

마찬가지로, 클로닝 또한 씬 프로비저닝의 한 형태입니다. 80TiB 데이터베이스의 복제본 40개를 사용하는 개발 환경은 완전히 기록될 경우 3.2PiB의 용량이 필요하지만, 실제로는 변경 사항만 저장되므로 훨씬 적은 용량이 사용됩니다.



== 공간 관리

애플리케이션 환경에서 씬 프로비저닝을 사용할 때는 데이터 변경률이 예기치 않게 증가할 수 있으므로 주의해야 합니다. 예를 들어, 데이터베이스 테이블의 인덱싱이 다시 수행되거나 VMware 게스트에 대규모 패치가 적용되는 경우 스냅샷으로 인한 공간 사용량이 급격히 증가할 수 있습니다. 백업 파일이 잘못된 위치에 저장되면 매우 짧은 시간 안에 엄청난 양의 데이터가 손실될 수 있습니다. 마지막으로, LUN의 사용 가능한 공간이 예기치 않게 부족해지는 경우 일부 애플리케이션을 복구하기 어려울 수 있습니다.

ASA r2에서는 볼륨 자동 확장이나 스냅샷 자동 삭제와 같은 ONTAP 기능 대신 *씬 프로비저닝*, *사전 예방적 모니터링*, *LUN 크기 조정 정책*을 통해 이러한 위험을 완화합니다. 관리자는 다음과 같이 해야 합니다.

* LUN에서 씬 프로비저닝을 활성화합니다. (`space-reserve disabled`) - 이것은 ASA r2의 기본 설정입니다.
* 시스템 관리자 알림 또는 API 기반 자동화를 사용하여 용량을 모니터링하세요.
* 확장에 맞춰 LUN 크기 조정을 예약하거나 스크립트로 실행하세요.
* 시스템 관리자(GUI)를 통해 스냅샷 예약 및 자동 스냅샷 삭제를 구성합니다.



CAUTION: ASA r2는 자동 볼륨 증가 또는 CLI 기반 스냅샷 삭제를 지원하지 않으므로 공간 임계값 및 자동화 스크립트를 신중하게 계획하는 것이 필수적입니다.

ASA r2는 WAFL 기반 볼륨 옵션을 추상화하는 SAN 전용 아키텍처이므로 부분 예비 용량 설정을 사용하지 않습니다. 대신 공간 효율성과 덮어쓰기 방지는 LUN 수준에서 관리됩니다. 예를 들어 스토리지 장치에서 250GiB LUN을 프로비저닝한 경우 스냅샷은 사전에 동일한 양의 공간을 예약하는 대신 실제 블록 변경량을 기준으로 공간을 사용합니다. 이로써 부분준비금을 사용하는 기존 ONTAP 환경에서 흔히 발생했던 대규모 고정 예약이 필요 없어집니다.


NOTE: 덮어쓰기 방지 기능이 필수적이고 모니터링이 불가능한 경우, 관리자는 스토리지 장치에 충분한 용량을 확보하고 스냅샷 예약량을 적절하게 설정해야 합니다. 하지만 ASA r2의 설계 덕분에 대부분의 워크로드에서 부분 예약이 필요하지 않습니다.



== 압축 및 중복제거

ASA r2의 압축 및 중복 제거는 기존의 씬 프로비저닝 메커니즘이 아니라 공간 효율성 기술입니다. 이러한 기능은 중복 데이터를 제거하고 블록을 압축하여 물리적 저장 공간을 줄여주므로, 기존 저장 용량으로는 불가능했던 더 많은 논리적 데이터를 저장할 수 있습니다.

예를 들어, 50TiB 크기의 데이터셋은 30TiB로 압축되어 20TiB의 물리적 공간을 절약할 수 있습니다. 응용 프로그램 관점에서 보면, 디스크에서 30TiB만 차지하더라도 여전히 50TiB의 데이터가 있는 셈입니다.


NOTE: 데이터셋의 압축률은 시간이 지남에 따라 변할 수 있으며, 이로 인해 물리적 공간 사용량이 증가할 수 있습니다. 따라서 압축 및 중복 제거는 모니터링과 용량 계획을 통해 사전에 관리해야 합니다.



== 여유 공간 및 LVM 공간 할당

ASA r2 환경에서 씬 프로비저닝은 삭제된 블록이 회수되지 않으면 시간이 지남에 따라 효율성이 떨어질 수 있습니다. TRIM/UNMAP 명령어를 사용하여 공간을 해제하거나 (ASMRU - 자동 공간 관리 및 복구 유틸리티를 통해) 0으로 덮어쓰지 않는 한, 삭제된 데이터는 계속해서 물리적 용량을 차지합니다. 대부분의 Oracle 데이터베이스 환경에서는 데이터 파일이 생성 시 전체 크기로 미리 할당되기 때문에 씬 프로비저닝의 이점이 제한적입니다.

LVM 구성을 신중하게 계획하면 효율성을 향상시키고 스토리지 프로비저닝 및 LUN 크기 조정 필요성을 최소화할 수 있습니다. Veritas VxVM이나 Oracle ASM과 같은 LVM을 사용하는 경우, 기본 LUN은 필요할 때만 사용되는 익스텐트로 분할됩니다. 예를 들어, 데이터 세트의 초기 크기가 2TiB이지만 시간이 지남에 따라 10TiB까지 증가할 수 있는 경우, 이 데이터 세트는 LVM 디스크 그룹으로 구성된 10TiB의 씬 프로비저닝 LUN에 배치할 수 있습니다. 생성 시에는 2TiB의 공간만 차지하며, 데이터 증가에 맞춰 익스텐트가 할당될 때만 추가 공간을 요구합니다. 이 과정은 공간을 모니터링하는 한 안전합니다.
