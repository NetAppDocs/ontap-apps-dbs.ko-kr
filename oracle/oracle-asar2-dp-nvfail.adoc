---
sidebar: sidebar 
permalink: oracle/oracle-asar2-dp-nvfail.html 
keywords: oracle, nvfail, ASA r2 
summary: ASA r2에서 Oracle 데이터베이스를 보호하도록 NVFAIL 구성 
searchtitle: Oracle 데이터베이스 및 ASA r2의 NVFAIL 문제 
---
= NVFAIL(* NVFAIL
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
NVFAIL은 심각한 장애 조치 시나리오에서 데이터 무결성을 보장하는 ONTAP 기능입니다.

이 기능은 ASA r2 시스템에서도 여전히 적용 가능합니다. ASA r2는 간소화된 SAN 아키텍처(볼륨 대신 SAZ 및 스토리지 유닛)를 사용하지만 말입니다.

데이터베이스는 대규모 내부 캐시를 유지하기 때문에 스토리지 장애 조치 이벤트 중에 데이터 손상에 취약합니다. 만약 심각한 재해로 인해 전체 구성의 상태와 관계없이 ONTAP 페일오버를 강제로 수행해야 하는 경우, 이전에 승인된 변경 사항이 사실상 폐기될 수 있습니다. 스토리지 어레이의 내용이 시간상으로 거꾸로 이동하면서 데이터베이스 캐시의 상태가 더 이상 디스크에 저장된 데이터의 상태를 반영하지 않게 됩니다. 이러한 불일치로 인해 데이터가 손상됩니다.

캐싱은 애플리케이션 계층 또는 서버 계층에서 발생할 수 있습니다. 예를 들어, 기본 사이트와 원격 사이트 모두에서 서버가 활성화된 Oracle Real Application Cluster(RAC) 구성은 Oracle SGA 내에 데이터를 캐시합니다. 데이터 손실을 초래하는 강제 장애 조치 작업은 SGA에 저장된 블록과 디스크의 블록이 일치하지 않을 수 있으므로 데이터베이스 손상 위험을 초래할 수 있습니다.

캐싱의 덜 명확한 용도 중 하나는 운영체제 파일 시스템 계층에서 활용하는 것입니다. 기본 사이트에 있는 LUN을 기반으로 하는 클러스터형 파일 시스템을 원격 사이트의 서버에 마운트할 수 있으며, 이를 통해 데이터를 다시 캐시할 수 있습니다. 이러한 상황에서 NVRAM 오류 또는 강제 인수(takeover)가 발생하면 파일 시스템 손상이 발생할 수 있습니다.

ONTAP NVFAIL 및 관련 설정을 사용하여 이러한 시나리오로부터 데이터베이스와 운영 체제를 보호합니다. NVFAIL 및 관련 설정은 호스트에 신호를 보내 장애 조치 후 캐시된 데이터를 무효화하고 영향을 받는 파일 시스템을 다시 마운트하도록 합니다. 이 메커니즘은 AFF/ FAS 에서와 마찬가지로 ASA r2 LUN 및 네임스페이스에도 적용됩니다.

[NOTE]
====
ASA r2의 주요 고려 사항:

* NVFAIL은 SAZ 레벨이 아닌 LUN(저장 장치) 레벨에서 작동합니다.
* Oracle 데이터베이스의 경우, 중요 구성 요소(데이터 파일, 리두 로그, 제어 파일)를 호스팅하는 모든 LUN에서 NVFAIL을 활성화해야 합니다.
* MetroCluster 는 ASA r2에서 지원되지 않으므로 NVFAIL은 주로 로컬 HA 페일오버 시나리오에 적용됩니다.
* ASA r2에서는 NFS가 지원되지 않으므로 NVFAIL 관련 고려 사항은 SAN 기반 워크로드(FC/iSCSI/NVMe)에만 적용됩니다.


====